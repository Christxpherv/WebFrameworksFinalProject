<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Table</title>
</head>
<body>

<%# clickable to sort the products by their price %>
<%= link_to "Sort by Price", "#sorted", id: "sortByPrice", class: "sort-link" %>

<%# create a table of the products and its categories, like an actual database  %>
<table class="products-table">
  <thead>
    <tr>
      <%# categories %>
      <th class="sortable">Name</th>
      <th class="sortable">Price</th>
      <th class="sortable">Quantity</th>
    </tr>
  </thead>
  <tbody>
    <%# iterate through the data in products and get its attributes to create a row %>
    <% @products.each do |product| %>
      <tr>
        <td><%= product.name %></td>
        <td><%= product.price %></td>
        <td><%= product.quantity %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
  $(document).ready(function() {
    // event listener for the click action 
    $('#sortByPrice').on('click', function(e) {
      e.preventDefault(); 
      
      // notify the console that the link was clicked (for debugging purposes)
      console.log("Sort by Price link clicked."); 
      
      // get the table and its rows
      const table = $('.products-table');
      const rows = table.find('tbody > tr').get();

      // sort the rows by the price of the product
      rows.sort((a, b) => {
        const aValue = parseFloat($(a).find('td').eq(1).text()); 
        const bValue = parseFloat($(b).find('td').eq(1).text()); 
        // notify the console of the values of the products
        console.log("aValue:", aValue);
        console.log("bValue:", bValue);
        // sort the products by their price in ascending order
        return aValue - bValue;
      });

      table.find('tbody').empty().append(rows);
    });
  });
</script>
</body>
</html>

